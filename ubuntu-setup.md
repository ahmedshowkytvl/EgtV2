
# إعداد الموقع للإنتاج على Ubuntu

## متطلبات النظام
- Ubuntu 18.04+ أو Debian 10+
- صلاحيات sudo
- اتصال بالإنترنت

## الطريقة السريعة (Ubuntu):

### 1. تحضير الملفات
```bash
# انسخ كل ملفات المشروع إلى مجلد على الخادم
# تأكد من وجود ملف .env مع إعدادات قاعدة البيانات
```

### 2. تشغيل الموقع
```bash
# اجعل الملف قابل للتنفيذ
chmod +x start-ubuntu.sh

# تشغيل الموقع
./start-ubuntu.sh
```

السكريبت سيقوم تلقائياً بـ:
- تثبيت Node.js 20 إذا لم يكن موجود
- تثبيت PM2 لإدارة العمليات
- تثبيت المكتبات المطلوبة
- بناء المشروع
- إعداد قاعدة البيانات
- تشغيل الموقع بـ PM2

### 3. الوصول للموقع
- الموقع سيعمل على: `http://localhost:3000`
- من أي جهاز في الشبكة: `http://[ip-الخادم]:3000`

### 4. إدارة الموقع

#### إيقاف الموقع
```bash
./stop-ubuntu.sh
```

#### إعادة تشغيل الموقع
```bash
./restart-ubuntu.sh
```

#### مراقبة الموقع
```bash
pm2 status                    # حالة العمليات
pm2 logs sahara-journeys     # عرض السجلات
pm2 monit                    # مراقب مباشر
```

## المتغيرات المطلوبة في .env:

```env
NODE_ENV=production
DATABASE_URL=postgresql://username:password@localhost:5432/database_name
PORT=3000
SESSION_SECRET=your-secure-secret-key
GOOGLE_AI_API_KEY=your-google-ai-api-key
```

## ملاحظات مهمة:

### الأمان
- تأكد من أن Port 3000 مفتوح في Firewall:
```bash
sudo ufw allow 3000
```

### النسخ الاحتياطي
- احتفظ بنسخة احتياطية من قاعدة البيانات
- احتفظ بنسخة من ملف .env

### تغيير المنفذ
- يمكن تغيير Port في ملف .env
- تذكر فتح المنفذ الجديد في Firewall

### تشغيل تلقائي عند إعادة التشغيل
السكريبت يقوم بإعداد PM2 للتشغيل التلقائي عند إعادة تشغيل الخادم.

## استكشاف الأخطاء:

### إذا فشل التثبيت:
```bash
# تحديث النظام
sudo apt update && sudo apt upgrade -y

# إعادة تشغيل السكريبت
./start-ubuntu.sh
```

### إذا فشل الاتصال بقاعدة البيانات:
- تحقق من إعدادات DATABASE_URL في .env
- تأكد من تشغيل خادم قاعدة البيانات

### عرض الأخطاء:
```bash
pm2 logs sahara-journeys
```
